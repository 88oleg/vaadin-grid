
<!-- Common imports for all examples -->
  <link rel="stylesheet" href="../../components-demo-resources/demo.css">
  <link rel="import" href="../../code-example/code-example.html">
  <link rel="import" href="../../table-of-contents/table-of-contents.html">
  <link rel="import" href="../../polymer/polymer.html">
  <link rel="import" href="../vaadin-grid.html">
  <script src="demodata.js"></script>
  <script src="../ga.js"></script>

  <!-- Common JS code for all examples -->
  <script>
    var randomUserUrl = 'https://randomuser.me/api';

    window.xCodeExampleSourceHead =
    "  <script src='https://cdn.vaadin.com/vaadin-components/latest/webcomponentsjs/webcomponents-lite.js'><\/script>\n"+
    "  <link href='https://cdn.vaadin.com/vaadin-components/latest/vaadin-grid/vaadin-grid.html' rel='import'>\n"+
    "  <script>var randomUserUrl = '" + randomUserUrl + "';<\/script>\n";

    function createButton(text, fnc) {
      var button = document.createElement("button");
      button.innerHTML = text;
      button.addEventListener("click", fnc);
      return button;
    }

    // Faking randomuser.me REST call since the site is sometimes unavailable.
    // We have a set of 200 users cached in a static .json file instead, we
    // take it via ajax and split it conveniently based on parameters.
    XMLHttpRequest.prototype._open = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype._rurl = new RegExp('(.*' + randomUserUrl + '.*)results=(\\d+).*');
    XMLHttpRequest.prototype.open = function(method, url, type) {
      this.r = this._rurl.exec(url);
      if (this.r) {
        url = "users.json?results=" + this.r[2];
        this._onreadystatechange = this.onreadystatechange;
        this.onreadystatechange = function() {
          if (this.readyState == XMLHttpRequest.DONE  && this.status == 200) {
            var json = JSON.parse(this.responseText);
            json.results = json.results.splice(0, this.r[2])
            this.responseText = JSON.stringify(json);
          }
          setTimeout(this._onreadystatechange, 300);
        }
      }
      this._open(method, url, type)
    }
  </script>
